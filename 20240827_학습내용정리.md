---

# Oracle에서 PK값 범위 정하기와 시퀀스 사용

Oracle에서 PK값의 범위를 지정하는 데 어려움을 겪을 때, 시퀀스(sequence)를 사용할 수 있습니다. 시퀀스는 자동으로 숫자를 생성하여 PK값으로 사용할 수 있도록 도와주는 기능입니다.

## 시퀀스와 사이클

- **시퀀스(sequence)**: 지정한 범위 내에서 숫자를 자동으로 생성합니다.  
- **사이클(cycle)**: 시퀀스가 지정된 최대 값에 도달하면 다시 처음으로 돌아가 1부터 값을 매깁니다.

### 문제점

사이클이 활성화된 시퀀스는 최대 범위까지 값이 생성되면 다시 1부터 시작하게 되므로, PK값이 중복되는 문제가 발생할 수 있습니다.

## 실무에서의 해결 방법

실제 운영 환경에서는 PK값의 중복을 피하기 위해 다음과 같은 방법을 사용합니다:

- **날짜를 포함한 PK값 사용**: PK값 앞에 날짜를 붙여 고유성을 보장합니다. 예를 들어, `202308270001`과 같이 날짜와 순번을 결합하여 사용합니다.

## 앞에 00000을 붙이는 이유

문자열 타입의 데이터를 정렬할 때, 숫자 값이 다음과 같이 정렬될 수 있습니다:

- `1`
- `2`
- `3`
- `4`
- `10`

이 데이터를 정렬하면:

- `1`
- `10`
- `2`
- `3`
- `4`

이런 식으로 정렬됩니다. 이를 피하기 위해, 숫자 앞에 `0`을 붙여서 정렬 시 자연스러운 순서를 유지할 수 있습니다. 예를 들어, `00001`, `00002`, `00003`과 같이 사용합니다.

## 캐시 (Cache)

시퀀스는 캐시 기능을 사용할 수 있습니다. 캐시는 지정한 값만큼 미리 값을 생성해 두고, 그 값들이 소진되면 즉시 새로운 값을 로드합니다. 이는 성능을 최적화하는 데 도움이 됩니다.

## 시퀀스 명명 규칙

실무에서는 시퀀스 명을 다음과 같이 작성합니다:

- **규칙**: `테이블명_PK_SEQ`
- **예시**: `MV_INFO_PK_SEQ`

이 규칙에 따라 시퀀스를 명명하면, 시퀀스의 용도를 쉽게 파악할 수 있습니다.

# DML(데이터 조작 언어) 요약

DML(Data Manipulation Language, 데이터 조작 언어)은 데이터베이스에서 데이터를 조회하고, 추가하고, 수정하고, 삭제하는 데 사용되는 SQL 명령어들의 집합입니다. DML은 데이터베이스에서 데이터를 실제로 다루는 작업을 수행하며, 다음과 같은 주요 명령어로 구성됩니다:

## SELECT

**SELECT** 문은 데이터베이스에서 데이터를 조회하는 데 사용됩니다. 이 명령어를 통해 테이블에서 특정 조건을 만족하는 데이터의 서브셋을 추출할 수 있습니다.

- **기본 문법**:
  
  ```sql
  SELECT 열_이름
  FROM 테이블_이름
  WHERE 조건;
  ```

- **예시**:
  
  ```sql
  SELECT * FROM employees WHERE department = 'Sales';
  ```

  이 예시는 `employees` 테이블에서 `department`가 'Sales'인 모든 열을 조회합니다.

## INSERT

**INSERT** 문은 새로운 데이터를 테이블에 추가하는 데 사용됩니다. 새로운 레코드를 테이블에 삽입할 때 사용되며, 삽입할 데이터는 지정된 열에 맞춰서 제공해야 합니다.

- **기본 문법**:
  
  ```sql
  INSERT INTO 테이블_이름 (열1, 열2, ...)
  VALUES (값1, 값2, ...);
  ```

- **예시**:
  
  ```sql
  INSERT INTO employees (first_name, last_name, department)
  VALUES ('John', 'Doe', 'Engineering');
  ```

  이 예시는 `employees` 테이블에 'John', 'Doe', 'Engineering' 값을 가진 새로운 레코드를 추가합니다.

## UPDATE

**UPDATE** 문은 기존 데이터를 수정하는 데 사용됩니다. 특정 조건을 만족하는 하나 이상의 레코드를 업데이트할 수 있으며, 변경하고자 하는 열과 새로운 값을 지정해야 합니다.

- **기본 문법**:
  
  ```sql
  UPDATE 테이블_이름
  SET 열1 = 값1, 열2 = 값2, ...
  WHERE 조건;
  ```

- **예시**:
  
  ```sql
  UPDATE employees
  SET department = 'Marketing'
  WHERE employee_id = 123;
  ```

  이 예시는 `employees` 테이블에서 `employee_id`가 123인 레코드의 `department` 값을 'Marketing'으로 수정합니다.

## DELETE

**DELETE** 문은 특정 조건을 만족하는 데이터를 테이블에서 삭제하는 데 사용됩니다. 이 명령어를 통해 테이블에서 하나 이상의 레코드를 삭제할 수 있습니다.

- **기본 문법**:
  
  ```sql
  DELETE FROM 테이블_이름
  WHERE 조건;
  ```

- **예시**:
  
  ```sql
  DELETE FROM employees
  WHERE employee_id = 123;
  ```

  이 예시는 `employees` 테이블에서 `employee_id`가 123인 레코드를 삭제합니다.

## 주의사항

- **트랜잭션**: 대부분의 DML 명령어는 트랜잭션 내에서 실행될 수 있습니다. 즉, `COMMIT` 명령어를 통해 변경 사항을 영구적으로 저장하거나, `ROLLBACK` 명령어를 통해 취소할 수 있습니다.
  
- **WHERE 절**: `UPDATE`와 `DELETE` 명령어를 사용할 때는 `WHERE` 절을 주의해서 사용해야 합니다. `WHERE` 절을 사용하지 않으면 테이블의 모든 레코드가 수정되거나 삭제될 수 있습니다.

---

